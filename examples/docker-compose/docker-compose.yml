services:
  docfabric-server:
    image: ghcr.io/rawe/docfabric-server:${VERSION:-latest}
    ports:
      - "8000:8000"
    environment:
      # Four slashes: sqlite+aiosqlite:// + absolute path /app/data/docfabric.db
      DATABASE_URL: sqlite+aiosqlite:////app/data/docfabric.db
      # Store uploaded files inside the persistent volume
      STORAGE_PATH: /app/data/storage
    volumes:
      - docfabric-data:/app/data

  docfabric-ui:
    image: ghcr.io/rawe/docfabric-ui:${VERSION:-latest}
    ports:
      - "3000:80"
    environment:
      # nginx proxies /api requests to this URL; uses the compose service name
      API_URL: http://docfabric-server:8000
    depends_on:
      - docfabric-server

volumes:
  docfabric-data:
